<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deptrack Findings</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    .finding { border: 1px solid #ccc; padding: 1em; margin-bottom: 1.5em; background: #fff; }
    .title { font-size: 1.2em; font-weight: bold; }
    .section { margin-top: 0.5em; }
    .finding pre { white-space: pre-wrap; margin: 0; padding: 0; font-family: inherit; }
  </style>
</head>
<body>
  <h1>Deptrack Findings Report</h1>
  {% for rpt in reports %}
    <div class="finding">
      <div class="title">Title: {{ rpt.title }}</div>
      <div class="section">Url: <a href="{{ rpt.url }}" target="_blank">{{ rpt.url }}</a></div>
      <div class="section">
        <strong>Vulnerable functions:</strong>
        <pre>
{% for fn in rpt.functions %}        {{ fn }}
{% endfor %}        </pre>
      </div>
      <div class="section">
        <strong>Vulnerable packages:</strong>
        <pre>
{% for pkg in rpt.packages %}        {{ pkg.package }}{% if pkg.version %}:{{ pkg.version }}{% endif %}
{% endfor %}        </pre>
      </div>
      <div class="section">
        <strong>Description:</strong>
        <pre>
{{ rpt.description }}
        </pre>
      </div>
    </div>
  {% endfor %}
</body>
</html>