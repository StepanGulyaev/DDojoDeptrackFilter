<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deptrack Findings</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    .finding { border: 1px solid #ccc; padding: 1em; margin-bottom: 1.5em; background: #fff; }
    .title { font-size: 1.2em; font-weight: bold; }
    .section { margin-top: 0.5em; }
    .finding pre { white-space: pre-wrap; margin: 0; padding: 0; font-family: inherit; }
  </style>
</head>
<body>
  <h1>Deptrack Findings Report</h1>
  
    <div class="finding">
      <div class="title">Title: vite:4.5.3 Affected By: CVE-2025-30208 (NVD)</div>
      <div class="section">Url: <a href="https://defectdojo-appsec-test.yadro.com/ddojo/finding/28" target="_blank">https://defectdojo-appsec-test.yadro.com/ddojo/finding/28</a></div>
      <div class="section">
        <strong>Vulnerable functions:</strong>
        <pre>
        </pre>
      </div>
      <div class="section">
        <strong>Vulnerable packages:</strong>
        <pre>
        vite:&lt;6.2.3
        vite:&lt;6.1.2
        vite:&lt;6.0.12
        vite:&lt;5.4.15
        vite:&lt;4.5.10
        </pre>
      </div>
      <div class="section">
        <strong>Description:</strong>
        <pre>
You are using a component with a known vulnerability. Version 4.5.3 of the vite component is affected by the vulnerability with an id of CVE-2025-30208 as identified by gsdId.
The purl of the affected component is: pkg:npm/vite@4.5.3.
Vulnerability Description: Vite, a provider of frontend development tooling, has a vulnerability in versions prior to 6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10. `@fs` denies access to files outside of Vite serving allow list. Adding `?raw??` or `?import&amp;raw??` to the URL bypasses this limitation and returns the file content if it exists. This bypass exists because trailing separators such as `?` are removed in several places, but are not accounted for in query string regexes. The contents of arbitrary files can be returned to the browser. Only apps explicitly exposing the Vite dev server to the network (using `--host` or `server.host` config option) are affected. Versions 6.2.3, 6.1.2, 6.0.12, 5.4.15, and 4.5.10 fix the issue.
        </pre>
      </div>
    </div>
  
    <div class="finding">
      <div class="title">Title: vite:4.5.2 Affected By: GHSA-xcj6-pq6g-qj4x (GITHUB)</div>
      <div class="section">Url: <a href="https://defectdojo-appsec-test.yadro.com/ddojo/finding/42" target="_blank">https://defectdojo-appsec-test.yadro.com/ddojo/finding/42</a></div>
      <div class="section">
        <strong>Vulnerable functions:</strong>
        <pre>
        </pre>
      </div>
      <div class="section">
        <strong>Vulnerable packages:</strong>
        <pre>
        vite:&gt;=6.0.0
        </pre>
      </div>
      <div class="section">
        <strong>Description:</strong>
        <pre>
You are using a component with a known vulnerability. Version 4.5.2 of the vite component is affected by the vulnerability with an id of GHSA-xcj6-pq6g-qj4x as identified by gsdId.
The purl of the affected component is: pkg:npm/vite@4.5.2.
Vulnerability Title: Vite allows server.fs.deny to be bypassed with .svg or relative paths
Vulnerability Description: ### Summary

The contents of arbitrary files can be returned to the browser.

### Impact

Only apps explicitly exposing the Vite dev server to the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host)) are affected..

### Details

#### `.svg`

Requests ending with `.svg` are loaded at this line.
https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290
By adding `?.svg` with `?.wasm?init` or with `sec-fetch-dest: script` header, the restriction was able to bypass.

This bypass is only possible if the file is smaller than [`build.assetsInlineLimit`](https://vite.dev/config/build-options.html#build-assetsinlinelimit) (default: 4kB) and when using Vite 6.0+.

#### relative paths

The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. `../../`).

### PoC

```bash
npm create vite@latest
cd vite-project/
npm install
npm run dev
```

send request to read `etc/passwd`

```bash
curl &#39;http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init&#39;
```

```bash
curl &#39;http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw&#39;
```
        </pre>
      </div>
    </div>
  
</body>
</html>